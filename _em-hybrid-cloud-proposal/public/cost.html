<!DOCTYPE html>
<html>

<head>
    <title>Proposal</title>

    <link id="styleLink" rel="stylesheet" href="https://em-proposal-assets.now.sh/public/style.css" />
    <link rel="icon" href="/favicon" type="img/ico">
    <link href="https://fonts.googleapis.com/css?family=Audiowide|Orbitron&display=swap" rel="stylesheet">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=UA-145179153-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'UA-145179153-1');
    </script> -->

</head>

<body style="min-width: 80vw;">
    <style>
        nav div {
            position: fixed;
            display: flex;
            flex-direction: column;
            top: 2vh;
            left: 1vw;
            text-align: left;
            z-index: 10000;
        }
        
        .link-text {
            font-size: 1em;
            padding: 5px 20px 5px 20px;
            background: transparent;
            margin: 5px;
            border: 2px solid black;
            color: black;
            border-radius: 8px;
        }
        
        .link-text:hover {
            background: black;
            color: white;
        }
    </style>
    <nav>
        <!-- <h3>Home</h3> -->
        <div class="container">
            <button id="desc" onclick="clickDesc()" class="link-text">Proposal description</button>
            <button id="cost" onclick="clickCost()" class="link-text">Proposal cost</button>
            <!-- <button class="link-text">link</button> -->
        </div>
    </nav>
    <h1>Em Hybrid Cloud Cost Estimation</h1>
    <div style="position: relative" class="content content-container">
        <div style="position: relative; width: 100%;">
            <!-- <img style="position: relative; min-width: 100%; height: auto" src="https://em-proposal-assets.now.sh/public/diagram.svg" alt="Some alt" /> -->
        </div>

        <div id="content"></div>
        <div id="content-table">

        </div>
    </div class="costing-caveats">
    $0 for the first 62,000 emails you send each month, and $0.10 for every 1,000 emails you send after that. $0.10 for every 1,000 emails you send.
    <div>
    </div>
    <script>
        var rows;

        function clickLink(param) {
            console.log('ev: ', param);
            switch (param) {
                case 'desc':
                    window.history.back()
                case 'cost':
                    location.href = '/cost';
            }
        }

        function clickDesc() {
            return location.href = '/desc';
        }

        function clickCost() {
            return location.href = '/cost';
        }

        function get(route) {
            return new Promise(async(resolve, reject) => {
                console.log('Running fetch');
                const response = await fetch(`${route}`).then(res => res.text()).catch(err => console.error(err));
                return resolve(response);
            });
        }
        var contentPart10 = document.getElementById('content');
        //contentPart10.classList.add('component-image');
        get('/getcost').then(html => contentPart10.innerHTML = html);

        var costTable = document.getElementById('content-table');
        get('/get-table').then(html => {
            costTable.innerHTML = html;
            get('https://api.exchangeratesapi.io/latest').then(async(curr) => {
                const rows = await document.getElementsByTagName('tr');
                const conFax = await JSON.parse(curr).rates.ZAR;
                await assignNextRows(conFax, rows);
            });
        });



        const unitCounts = [{
            //cell: 'solcomp',

        }]

        function assignNextRows(conFac, rows) {
            console.log('rows: ', rows);
            console.log('conFac: ', conFac);
            for (let i = 0; i < rows.length; i++) {
                // console.log(rows[i]);
                const thisRow = rows[i];
                const cellToCheck = thisRow.children[2];
                const cellToUpdate = thisRow.insertCell();
                const unitCount = unitCounts[i]
                const unitPriceInRand = Number(cellToCheck.innerText) * conFac; // unit price in dallors

                console.log('thisRow: ', thisRow);
                console.log('thisRow[2]: ', cellToCheck);
            }

        }



        // console.log(currJson);
        // console.log('ZAR: ', ZAR);
        // console.log('valuesConvert: ', valuesConvert);
        // console.log('rows: ', rows.item(3));


        // for (let i = 0; i < rows.length; i++) {
        //     let newCell;
        //     const row = rows[i];
        //     console.log('row: ', row);
        //     const cellToConv = valuesConvert[i];
        //     console.log('cellToConv: ', cellToConv);


        //     console.log('row.cells: ', row.cells);
        //     row.insertCell().classList.add('converted-value');
        //     newCell = row.cells[3];
        //     console.log('newCell: ', newCell);

        //     //row.cells[3].textContent = row.cells[3].classList.includes('noconv') ? 150 : Number(row.cells[2].textContent) * ZAR;



        // }
    </script>
</body>

</html>